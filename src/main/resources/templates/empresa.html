<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<title>Digital Sutor :: Dashboard</title>
<th:block th:include="fragments/basiclayout.html :: headerfiles">
</th:block>

</head>
<body class="fixed-nav sticky-footer bg-dark">

	<nav
		th:replace="fragments/basiclayout.html :: userData(${nome}, ${ultimonome})"></nav>

	<div class="content-wrapper">
		<div class="container-fluid">

			<ol class="breadcrumb">
				<li class="breadcrumb-item"><a href="#">Empresas</a></li>
				<li class="breadcrumb-item active">Cadastro de Empresas</li>
			</ol>
			
			<div class="alert alert-danger" th:if="${errorMessage}" th:text="${errorMessage}"></div>
			
			<div class="card mb-3">
				<div class="card-header">
					<i class="far fa-building"></i> Dados da Empresa
				</div>
				<div class="card-body">
					<form th:action="@{/empresa}" method="POST" th:object="${empresa}">
						<div class="form-group">
							<div class="form-row">
								<div class="col-md-6">
									<label for="nome">Nome</label> <input class="form-control"
										type="text" name="nome" id="nome" th:field="*{nome}" th:errorclass="is-invalid">
										<div class="invalid-feedback" th:if="${#fields.hasErrors('nome')}" th:errors="*{nome}" ></div>
								</div>
								<div class="col-md-6">
									<label for="cnpj">CNPJ</label> <input class="form-control"
										type="text" name="cnpj" id="cnpj" th:field="*{cnpj}" data-mask="00.000.000/0000-00" th:errorclass="is-invalid">
									<div class="invalid-feedback" th:if="${#fields.hasErrors('cnpj')}" th:errors="*{cnpj}" ></div>
								</div>
							</div>
						</div>
						<div class="form-group">
							<label for="descricao">Descrição</label>
							<textarea class="form-control" name="descricao" id="descricao"
								th:field="*{descricao}" rows="5"></textarea>
						</div>

						<div class="form-group">
							<div class="card" id="aliqgroup">
								<div class="card-header">
									<i class="far fa-money-bill-alt"></i> Enquadramento da Empresa
								</div>
								<div class="card-body">
									<div th:each="tipo, status : ${tipoAliq}" class="form-group">
										<a data-toggle="collapse"
											th:attr="data-target='#aliquotas[' +${status.index}+ '].tipo'"
											th:href="'#aliquotas[' +${status.index}+ '].tipo'"> <span
											th:text="${tipo}"></span>
										</a>
										<div class="collapse"
											th:id="'aliquotas[' +${status.index}+ '].tipo'">
											<input class="form-control" type="text" th:field="*{aliquotas[__${status.index}__].aliquota}">
											<input type="hidden" th:attr="name='aliquotas[__${status.index}__].tipo'" th:value="${tipo}">
										</div>
									</div>
								</div>
							</div>
						</div>

						<div class="form-group">
							<div class="card">
								<div class="card-header">
									<i class="fas fa-users"></i> Usuários vinculados à Empresa
								</div>
								<div class="card-body">
									<div class="table-responsive">
										<div id="dataTable_wrapper"
											class="dataTables_wrapper container-fluid dt-bootstrap4">
											<div class="row">
												<div class="col-sm-12">
													<table class="table table-bordered dataTable"
														id="dataTable" width="100%" cellspacing="0" role="grid"
														aria-describedby="dataTable_info" style="width: 100%;">
														<thead>
															<tr role="row">
																<th class="sorting" tabindex="0"
																	aria-controls="dataTable" rowspan="1" colspan="1"
																	aria-label="Position: activate to sort column ascending"
																	style="width: 1px;"></th>
																<th class="sorting_asc" tabindex="0"
																	aria-controls="dataTable" rowspan="1" colspan="1"
																	aria-sort="ascending"
																	aria-label="Name: activate to sort column descending"
																	style="width: 152px;">Nome</th>
																<th class="sorting" tabindex="0"
																	aria-controls="dataTable" rowspan="1" colspan="1"
																	aria-label="Position: activate to sort column ascending"
																	style="width: 238px;">E-mail</th>
															</tr>
														</thead>
														<tfoot>
															<tr>
																<th rowspan="1" colspan="1"></th>
																<th rowspan="1" colspan="1">Nome</th>
																<th rowspan="1" colspan="1">E-mail</th>
															</tr>
														</tfoot>
														<tbody>
															<tr role="row" class="odd" th:each="usuario, status : ${empresa.usuarios}">
																<td><input type="checkbox" id="checkUsuario">
																<td class="sorting_1" th:text="${usuario.nome} + ' ' + ${usuario.ultimonome}"></td>
																<td th:text="${usuario.email}"></td>
															</tr>
														</tbody>
													</table>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="card-footer">
									<a class="btn btn-primary" href="#">
										<i class="fas fa-user-plus"></i>
										Vincular usuários
									</a>
									<a class="btn btn-danger" href="#">
										<i class="fas fa-user-minus"></i>
										Remover usuários
									</a>
								</div>
							</div>
						</div>
						
						<div class="form-group">
							<div class="form-row">
								<div class="col align-self-end text-right">
									<button type="submit" class="btn btn-primary">
										<i class="fas fa-share-square"></i>
										Salvar Empresa
									</button>
									<a class="btn btn-danger" href="#" onClick="window.history.go(-1)">
										<i class="fas fa-ban"></i>
										Cancelar
									</a>
								</div>
							</div>
						</div>

					</form>
				</div>
			</div>

		</div>
	</div>

	<footer th:insert="fragments/basiclayout.html :: footer.sticky-footer"></footer>
	
	<!--  
	<a class="scroll-to-top rounded" href="#page-top" style="display: inline;">
		<i class="fa fa-angle-up"></i>
	</a>
	-->

	<div th:insert="fragments/basiclayout.html :: logoutModal"></div>

	<!-- Bootstrap core JavaScript-->
	<script src="jquery/jquery.min.js"></script>
	<script src="jquery/jquery.mask.min.js"></script>
	<script src="bootstrap/js/bootstrap.bundle.min.js"></script>

	<!-- Core plugin JavaScript-->
	<script src="jquery-easing/jquery.easing.min.js"></script>

	<!-- Page level plugin JavaScript-->
	<script src="chart.js/Chart.min.js"></script>
	<script src="datatables/jquery.dataTables.js"></script>
	<script src="datatables/dataTables.bootstrap4.js"></script>

	<!-- Custom scripts for all pages-->
	<script src="custom/js/sb-admin.min.js"></script>

	<!-- Custom scripts for this page-->
	<script src="custom/js/sb-admin-datatables.min.js"></script>
	<script src="custom/js/sb-admin-charts.min.js"></script>
	
	<script>
		$(document).ready(function(){
			$("#cnpj").mask('00.000.000/0000-00', {reverse: true});
		});
	</script>

</body>
</html>